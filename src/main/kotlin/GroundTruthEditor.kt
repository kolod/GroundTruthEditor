package io.github.kolod

import com.formdev.flatlaf.FlatLightLaf
import com.jcabi.manifests.Manifests
import org.slf4j.LoggerFactory
import java.awt.Dimension
import java.awt.Image
import java.awt.Toolkit
import java.util.*
import javax.swing.JFrame
import javax.swing.SwingUtilities

class GroundTruthEditor : JFrame() {
	private val logger = LoggerFactory.getLogger(GroundTruthEditor::class.java)
	private val bundle = ResourceBundle.getBundle("i18n/GroundTruthEditor")

	private fun loadIcons(name :String, extension :String = "png") :List<Image> {
		val toolkit = Toolkit.getDefaultToolkit()
		return listOf(16, 24, 32, 48, 64, 72, 96, 128, 256).map{ size ->
			"$name$size.$extension"
		}.mapNotNull{ path ->
			javaClass.classLoader.getResource(path)
		}.mapNotNull{ url ->
			try {
				toolkit.createImage(url)
			} catch (ex: Exception) {
				logger.warn(ex.message, ex)
				null
			}
		}
	}

	private fun translateUI() {
		with(bundle) {
			title                   = getString("title") + " " + Manifests.read("Build-Date")
		}
	}

	/**
	 * This method is called from within the constructor to initialize the form. WARNING: Do NOT modify this code. The
	 * content of this method is always regenerated by the Form Editor.
	 */
	private fun initComponents() {
		preferredSize = Dimension(800, 600)
		defaultCloseOperation = EXIT_ON_CLOSE
		iconImages = loadIcons("icon/")

		translateUI()

		pack()
		setLocationRelativeTo(null)
	}

	/**
	 * Creates new form TestTrainer
	 */
	init {
		logger.info("Application started")
		initComponents()
	}

	companion object {
		/**
		 * @param args the command line arguments
		 */
		@JvmStatic
		fun main(args: Array<String>) {
			FlatLightLaf.setup()
			SwingUtilities.invokeLater { GroundTruthEditor().isVisible = true }
		}
	}
}
